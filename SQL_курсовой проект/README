

В качестве своей курсовой работы я выбрал ресурс, который непосредственно связан с моей основной занятостью на данный момент, так как система мне предельно понятна, но в то же время довольно специфична.

Моя база данных создана по примеру онлайн-системы регистрации на экзамен IELTS - международное тестирование по английскому языку - https://my.ieltsrussia.ru (адрес российского домена).

Регистрационная система представляет из себя онлайн ресурс по созданию букингов на различные типы и форматы экзамена IELTS.

Порядок регистрации проходит следующим образом:
    - Пользователь создаёт себе аккаунт: юзернэйм, пароль, указывает почту, ФИО, адрес, контактный тф. и тд. Вводимые данные на этом этапе (в моей интерпретации БД) распределяются на две таблицы: users и profiles 
    
    - Пользователь выбирает город сдачи. Доступные города сдачи по именам, с указанием "уровня доступа" (головной офис или региональный), а также цены экзамена (варьируются по городам) перечисляются в таблице cities. Города имеют          внешний ключ, ссылающийся на таблицу centres, в которой перечислены Центры IELTS. Под именем центра объединяются головной офис + некоторое количество региональных определенных регионов России (или других стран). 
    
    - Пользователь выбирает - тип экзамена: Regular (предназначающийся для использования результатов тестирования во всех странах мира кроме Великобритании) и UKVI (специализированный для имиграции в UK).
                            - формат сдачи экзамена: компьютерный или бумажный, а в случае выбора типа UKVI предоставляется еще и третий формат (специально для супружеской визы) - IELTS Life Skills
                            - модуль: Academic (для высших учебных заведений) или General (для трудовой визы или иммиграции) для основных экзаменов, а в случае Life Skills - A1 и B1 по уровням сложности экзамена. 
                            каждому отдельному сочетанию тип + формат + модуль выделен специальный id, все они перечислены в таблице exams.
    
    - Каждый город может иметь несколько авторизованных локаций проведения теста. Локации с адресами перечислены в отдельной таблице locations, ссылаются на свой город по внешнему ключу - city_id.
    
    - После окончания регистрации Пользователь должен произвести оплату экзамена в соответствии с ценой по выбранному городу. Все платежи, поступающие на счёт центра добавляются в таблицу payments. Доступны три вида платежей - наличными(cash), по квитанции(offline), онлайн на сайте (online). Назначение платежа: помимо оплат за экзамен, поступающих на счета центров, центры также получают оплаты за выпуск дополнительных сертификатов с результатами, а также взнос за апелляцию результатов. Таблица payments также содержит записи выплат пользователям в случае отмена экзамена. Таблица платежей ссылается по внешним ключам на бронирования пользователей, перечисленные в таблице candidates, имеет графу суммы транзакции, а также дополнительную графу extra - на случай, если пользователь оплатил излишнюю или недостаточную сумму. Апдейт этой графы по всем платежам осуществляется запуском хранимой процедуры. Значения extra суммируются в специально предназначенную графу в таблице users.deposit, отображающую баланс пользователя. 
    
    - Бронирования (candidates) уникальны и в свою очередь ссылаются на таблицу sessions, в которой перечисляются все доступные экзаменационные сессии. Таблица candidates имеет такие колонки как payment_status и payment_id, свидетельствующие о том, оплачено ли конкретное бронирование. Таблица sessions объединяет в себе уникальные параметры проводимых сессий: id, дату, город, номер центра, id площадки (location_id), общее кол-во выделенных мест и занятых мест (allocated и taken). При создании бронирования на некоторую сессию, один из триггеров обновляет число занятых мест, в то время как другой предотвращает создание бронирование, если все места заняты. 
    
    База данных также содержит следующие незаполненные таблицы, которые сопряжены с определенным контролем, проводимым администраторами вручную:
        * Verification - таблица предназначена для работы с паспортными данными пользователя: 
                user_id - ссылается на пользователя, загрузившего документ,
                type - тип загруженного док-та: паспорт или нац. удостоверение личности
                id_number - номер паспорта
                expiry_date - дата истечения срока действия паспорта
                authority - отдел, выдавший док-т
                filename - имя файла загруженной копии док-та
                size(mb) - размер файла в мегабайтах.
                filepath - путь к файлу на сервере
                status - проверен или непроверен супервайзерами центра на актуальность
        
        * Results - таблица результатов экзамена, в которую заносятся оценки по каждой из частей экзамена и общий балл. Ссылается по внешнему ключу на соответствующее бронирование.
                trf_number - номер сертификата с результатами, выпущенного для данного пользователя
        
        * Organizations - список учебных заведений, авторизованных организаций, для которых результаты пользователей могут быть предоставлены электронно через базу, к которой они подключены.
        
        * Submitted_results - таблица, перечисляющая отправки результатов подключенным организациям. По внешним ключам ссылается на таблицу результатов и табл. с перечнем подключенных организаций/вузов.
        
        * Invitations - таблица, перечисляющая отправки персональных приглашений на экзамен пользователям.
        
В проекте содержатся следующие файлы:
    - IELTS_db (скрипт создания бд)
    - IELTS_data_insertion (скрипт вставки данных)
    - IELTS_db_actions (скрипт с процедурами и триггерами)
    - IELTS_db_views (скрипт с представлениями)
    - IELTS_ERDiagram (экпорт ER диаграммы из Dbeaver)
    - черновик сообщения таблиц по внешним ключам (составлял до создания бд, как макет)

